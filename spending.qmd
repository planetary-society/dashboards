---
title: NASA Science Spending by Congressional District
format:
  dashboard:
    pagetitle: NASA Science Spending Maps
    description-meta: "Interactive maps displaying NASA science contract obligations by U.S. congressional district and state."
    author-meta: "The Planetary Society"
    logo: "img/TPS_Logo_3Stack-White.png"
    lang: en
    nav-buttons:
      - href: mailto:casey.dreier@planetary.org
        text: "Contact"
    theme: yeti
    css: custom.css
    include-in-header:
      - text: |
          <link rel="preconnect" href="https://fonts.googleapis.com">
          <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
          <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap" rel="stylesheet">
          <script>
            window.addEventListener('load', function() {
                setTimeout(function() {
                    const logoAnchor = document.querySelector('a[href="#"]');
                    if (logoAnchor && logoAnchor.querySelector('.navbar-logo')) {
                        logoAnchor.href = 'https://planetary.org';
                        logoAnchor.target = '_blank';
                        logoAnchor.title = 'The Planetary Society';
                    }
                }, 1000);
            });
          </script>
---

```{python}
#| echo: false
#| include: false

import sys
sys.path.append('src')

from us_spending_maps import USSpendingMaps, create_spending_map
import pandas as pd
from datetime import datetime
import os

# Load and prepare data
science_district_csv_path = 'data/NASA-district-Science-summary.csv'
science_state_csv_path = 'data/NASA-state-Science-summary.csv'
district_last_updated = datetime.fromtimestamp(os.path.getmtime(science_district_csv_path))

# Create dashboard data using the convenience function
district_result = create_spending_map(
  csv_path=science_district_csv_path,
  geo_col="district",
  level="district",
  value_cols=["fy_2024_obligations", "fy_2023_obligations","fy_2022_obligations"],
  use_stepped=True,
  geojson_path="us_congressional_districts.geojson"
)
district_map = district_result['map']

state_result = create_spending_map(
  csv_path=science_state_csv_path,
  geo_col="state",
  level="state",
  value_cols=["fy_2024_obligations", "fy_2023_obligations","fy_2022_obligations"],
  use_stepped=True,
  geojson_path="us_states.geojson"
)
state_map = state_result['map']

```

# NASA Science Spending Maps {.tabset}

## Districts

```{python}
#| title: "NASA Science Spending by Congressional District (FY22-24 Average)"
#| component: card
#| echo: false

display(district_map)
```

## States

```{python}
#| title: "NASA Science Spending by State (FY22-24 Total)" 
#| component: card
#| echo: false

display(state_map)

```

## Data Summary

::: {.card}
**Data Summary**

- **Last Updated:** `{python} district_last_updated.strftime("%B %-d, %Y")`
- **Data Source:** USASpending.gov

**About the Data**

This dashboard displays the average annual NASA Science Mission Directorate contract obligations by congressional district for fiscal years 2022-2024. The data includes research grants, contracts, and cooperative agreements supporting NASA's science programs including Earth Science, Planetary Science, Astrophysics, and Heliophysics.

**Color Scale**

The map uses a logarithmic color scale to better visualize the wide range of spending values across districts. Darker blue indicates higher spending levels.

:::